<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <title>环网箱监控</title>
    <link rel="stylesheet" type="text/css" href="../Content/mdl-v1.1.2/material.min.css">
    <link rel="stylesheet" href="../Static/css/base.css">
    <link rel="stylesheet" type="text/css" href="../Static/css/style.css">
</head>

<body>
    <div class="wrapper">
        <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
            <header class="mdl-layout__header">
                <div class="mdl-layout__header-row">
                    <div id="back" class="material-icons md-36 back-icon" style="visibility: hidden;" data-state="0">navigate_before</div>
                    <h1 class="mdl-layout__title" id="title">实时状态</h1>
                    <div class="mdl-layout-spacer"></div>
                    <div class="mdl-navigation">
                        <a class="material-icons mdl-badge mdl-badge--overlap" id="warning" href="Warninfo.html">notifications</a>
                    </div>
                </div>
            </header>
            <main class="mdl-layout__content" data-state="false">
                <div class="content sections" id="scrollable">
                    <div class="loading">
                        <div class="mdl-spinner mdl-js-spinner is-active"></div>
                    </div>
                    <div class="equipment-list section-1" id="pageMain">
                        <div class="mdl-list box-line">
                            <div class="mdl-list__item">
                                <span class="mdl-list__item-primary-content">内部温度</span>
                                <span class="mdl-list__item-secondary-content" id="i-temp"></span>
                            </div>
                            <div class="mdl-list__item">
                                <span class="mdl-list__item-primary-content">内部湿度</span>
                                <span class="mdl-list__item-secondary-content" id="i-humidity"></span>
                            </div>
                            <div class="mdl-list__item">
                                <span class="mdl-list__item-primary-content">外部温度</span>
                                <span class="mdl-list__item-secondary-content" id="o-temp"></span>
                            </div>
                            <div class="mdl-list__item">
                                <span class="mdl-list__item-primary-content">外部湿度</span>
                                <span class="mdl-list__item-secondary-content" id="o-humidity"></span>
                            </div>
                            <div id="fanState"></div>
                            <a class="mdl-list__item current-page swipeBtn" href="javascript:;" data-href="#chart">
                                <span class="mdl-list__item-primary-content"><i class="material-icons blue mr8">insert_chart</i>图表</span>
                                <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                            </a>
                            <div class="mdl-list__item">
                                <span class="mdl-list__item-primary-content"><i class="material-icons blue mr8">access_time</i>更新时间</span>
                                <span class="mdl-list__item-secondary-content" id="updateTime"></span>
                            </div>
                            <div class="mdl-list__item mdl-list__item-line"></div>
                            <a class="mdl-list__item" id="history" href="#">
                                <span class="mdl-list__item-primary-content"><i class="material-icons blue mr8">history</i>历史数据</span>
                                <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                            </a>
                            <div class="mdl-list__item mdl-list__item-line"></div>
                            <a class="mdl-list__item current-page swipeBtn" href="javascript:;" data-href="#communication">
                                <span class="mdl-list__item-primary-content"><i class="material-icons blue mr8">call</i>通讯方式</span>
                                <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                            </a>
                            <a class="mdl-list__item current-page swipeBtn" href="javascript:;" data-href="#settings">
                                <span class="mdl-list__item-primary-content"><i class="material-icons blue mr8">settings</i>设置参数</span>
                                <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="chart" style="position: relative;">
                    <div class="change-chart-btn" id="changeChart">
                        <button class="active" id="drawChart1">曲线式</button>
                        <button id="drawChart2">比例式</button>
                    </div>
                    <div id="hChart" style="width:100%;height:100%;">
                    </div>
                </div>
                <div class="equipment-panel section-2" id="communication">
                    <div class="mdl-list box-line">
                        <div class="mdl-list__item">
                            <span class="mdl-list__item-primary-content">短信中心</span>
                            <span class="mdl-list__item-secondary-content">xxxxxxx</span>
                        </div>
                        <div class="mdl-list__item">
                            <span class="mdl-list__item-primary-content">设备IP</span>
                            <span class="mdl-list__item-secondary-content" id="ip"></span>
                        </div>
                        <div class="mdl-list__item">
                            <span class="mdl-list__item-primary-content">设备手机号</span>
                            <span class="mdl-list__item-secondary-content">xxxxxxxx</span>
                        </div>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="settings">
                    <div class="demo-list-two mdl-list box-line box-line-two">
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify0">
                            <span class="mdl-list__item-primary-content">
                                <span>低温关闭门限(℃)</span>
                            <span class="mdl-list__item-sub-title">
                                    <i>下限: 1111</i>
                                    <i>上限: 1111</i>
                                </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify1">
                            <span class="mdl-list__item-primary-content">
                                <span>高温关闭门限(℃)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify2">
                            <span class="mdl-list__item-primary-content">
                                <span>高湿关闭门限(％)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify3">
                            <span class="mdl-list__item-primary-content">
                                <span>转速控制门限(％)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify4">
                            <span class="mdl-list__item-primary-content">
                                <span>低温关闭门限(℃)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify5">
                            <span class="mdl-list__item-primary-content">
                                <span>低湿关闭门限(％)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify6">
                            <span class="mdl-list__item-primary-content">
                                <span>间歇运行门限(℃)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                                <i>上限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify7">
                            <span class="mdl-list__item-primary-content">
                                <span>间歇运行启动时间(分)(范围:0-240)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item mdl-list__item--two-line swipeBtn" href="javascript:;" data-href="#modify8">
                            <span class="mdl-list__item-primary-content">
                                <span>间歇运行停止时间(分)(范围:0-240)</span>
                            <span class="mdl-list__item-sub-title">
                                <i>下限: 1111</i>
                            </span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item swipeBtn" href="javascript:;" data-href="#modify9">
                            <span class="mdl-list__item-primary-content">
                                <span class="mdl-list__item-primary-content">温度报警值(℃)</span>
                            <span class="mdl-list__item-secondary-content">11111</span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item swipeBtn" href="javascript:;" data-href="#modify10">
                            <span class="mdl-list__item-primary-content">
                                <span class="mdl-list__item-primary-content">湿度报警值(℃)</span>
                            <span class="mdl-list__item-secondary-content">11111</span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                        <a class="mdl-list__item swipeBtn" href="javascript:;" data-href="#modify11">
                            <span class="mdl-list__item-primary-content">
                                <span class="mdl-list__item-primary-content">报警中心号码</span>
                            <span class="mdl-list__item-secondary-content">11111</span>
                            </span>
                            <span class="mdl-list__item-secondary-content"><i class="material-icons">navigate_next</i></span>
                        </a>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify0">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify1">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify2">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify3">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify4">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify5">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify6">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">下限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify7">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify8">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify9">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify10">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
                <div class="equipment-panel section-2" id="modify11">
                    <div class="mdl-textfield mdl-js-textfield">
                        <input class="mdl-textfield__input" type="number" pattern="-?[0-9]*(\.[0-9]+)?" id="sample2">
                        <label class="mdl-textfield__label" for="sample2">上限</label>
                        <span class="mdl-textfield__error">Input is not a number!</span>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script src="../Scripts/jquery-2.2.1.min.js"></script>
    <script src="../Static/js/jquery-slide.js"></script>
    <script src="../Content/mdl-v1.1.2/material.min.js"></script>
    <script src="../Scripts/echarts.common.min.js"></script>
    <script src="../Static/js/common.js"></script>
    <script>
    var reg = new RegExp('(^|&)id=([^&]*)(&|$)');
    var r = window.location.search.substr(1).match(reg) ?
        window.location.search.substr(1).match(reg)[2] : '00000010';
    $('#history').attr('href', 'NodeHistory.html?id=' + r);

    $('.mdl-layout__content').height(viewHeight - $('.mdl-layout__header').height());
    $('.mdl-tabs-panel-lg').height(viewHeight - $('.mdl-layout__header').height() - $('.mdl-tabs__tab-bar').height());

    $('.wrapper').PageSwipe({
        level: 2
    });

    var settings = {
        url: 'http://boxapi.losta.net/apiv1/datum/nodeStatus/' + r,
        type: 'GET',
        dataType: 'json'
    };

    $.ajax(settings).done(getStatus);

    $('#hChart').css({
        'width': viewWidth + 'px',
        'height': viewHeight - $('.mdl-layout__header').height() + 'px'
    });
    var hChart = echarts.init(document.getElementById('hChart'));
    hChart.showLoading();
    $.get('http://boxapi.losta.net/apiv1/datum/history/' + r, function(data) {
        hChart.hideLoading();

        var settingsPic = {
            url: 'http://boxapi.losta.net/apiv1/datum/history/' + r + '?pagesize=5000',
            type: 'GET',
            dataType: 'json'
        };
        $.ajax(settingsPic).done(function(data) {
            hChart.hideLoading();
            drawChart(hChart, data);
        });
    });

    // var touchScroll = function(e) {
    //     if (touchmovePos) {
    //         var moveDis = touchmovePos.y - touchStartPos.y,
    //             scrollH = document.getElementById('scrollable').scrollHeight,
    //             clientH = document.getElementById('scrollable').clientHeight,
    //             scrollT = document.getElementById('pageMain').scrollTop,
    //             $scrollable = $('#scrollable');
    //         if (moveDis > viewHeight / 3 && scrollT == 0) {
    //             $scrollable.css({
    //                 '-webkit-animation': 'refreshOut 200ms 1 linear',
    //                 'animation-fill-mode': 'forwards'
    //             });
    //             $.ajax(settings).done(doAjax);
    //             var scrollableFun = function() {
    //                 if ($scrollable.attr('data-state') == 'true' && touchState == 'TE') {
    //                     $scrollable.css({
    //                         '-webkit-animation': 'refreshIn 200ms 1 linear',
    //                         'animation-fill-mode': 'forwards'
    //                     });
    //                     touchstartPos = null;
    //                     touchmovePos = null;
    //                     clearInterval(scrollableFun);
    //                 }
    //             };
    //             setInterval(scrollableFun, 20);
    //         }
    //         if (moveDis > 0 && moveDis < viewHeight / 3 && scrollT == 0 || moveDis < 0 && scrollH == (scrollT + clientH + 1)) {
    //             e.preventDefault();
    //         }
    //     }
    // };
    // document.getElementById('scrollable').addEventListener('touchstart', touchHandler);
    // document.getElementById('scrollable').addEventListener('touchmove', touchHandler);
    // document.getElementById('scrollable').addEventListener('touchend', touchHandler);



    </script>
</body>

</html>
